<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centro de Salud Cartagena Este</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;800&family=Source+Sans+3:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root{--primary:#1a6b4a;--primary-light:#238c62;--primary-dark:#0f4a33;--accent:#d4a853;--accent-light:#f0d68a;--bg-dark:#1a1f2e;--bg-card:#fff;--bg-main:#f4f6f8;--bg-subtle:#e9edf2;--text:#2d3748;--text-light:#64748b;--text-muted:#94a3b8;--border:#e2e8f0;--border-light:#f1f5f9;--shadow-sm:0 1px 3px rgba(0,0,0,.06);--shadow-md:0 4px 12px rgba(0,0,0,.08);--shadow-lg:0 8px 30px rgba(0,0,0,.15);--radius:12px;--radius-sm:8px;--font-display:'Playfair Display',Georgia,serif;--font-body:'Source Sans 3',-apple-system,sans-serif}
        *{margin:0;padding:0;box-sizing:border-box}body{font-family:var(--font-body);background:var(--bg-main);color:var(--text)}

        /* ‚ïê‚ïê‚ïê LANDING PAGE ‚ïê‚ïê‚ïê */
        .landing{min-height:100vh;display:flex;flex-direction:column}
        .landing-nav{background:var(--bg-dark);padding:0 40px;height:60px;display:flex;align-items:center;justify-content:space-between;z-index:10}
        .landing-nav .brand{display:flex;align-items:center;gap:12px;color:#fff}
        .landing-nav .brand .logo{width:36px;height:36px;background:linear-gradient(135deg,var(--primary),var(--primary-light));border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1.1rem}
        .landing-nav .brand h1{font-family:var(--font-display);font-size:1.15rem;font-weight:600}
        .landing-nav .brand h1 span{color:var(--accent)}
        .landing-nav .nav-links{display:flex;gap:8px}
        .landing-nav .nav-links a{color:rgba(255,255,255,.7);text-decoration:none;font-size:.85rem;font-weight:500;padding:8px 16px;border-radius:6px;transition:.2s}
        .landing-nav .nav-links a:hover{color:#fff;background:rgba(255,255,255,.08)}
        .hero{flex:1;position:relative;display:flex;align-items:center;justify-content:center;min-height:calc(100vh - 60px);overflow:hidden}
        .hero-bg{position:absolute;inset:0;background:url('https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d?w=1600&q=80') center/cover;filter:brightness(.35)}
        .hero-overlay{position:absolute;inset:0;background:linear-gradient(135deg,rgba(26,31,46,.85),rgba(15,74,51,.7))}
        .hero-content{position:relative;z-index:2;text-align:center;max-width:800px;padding:40px 20px}
        .hero-badge{display:inline-block;background:rgba(212,168,83,.15);border:1px solid rgba(212,168,83,.3);color:var(--accent-light);padding:6px 20px;border-radius:30px;font-size:.82rem;font-weight:600;letter-spacing:.05em;margin-bottom:24px;text-transform:uppercase}
        .hero-content h2{font-family:var(--font-display);font-size:3.2rem;font-weight:800;color:#fff;line-height:1.15;margin-bottom:16px;letter-spacing:-.02em}
        .hero-content p{font-size:1.15rem;color:rgba(255,255,255,.75);line-height:1.6;margin-bottom:40px;font-weight:300;max-width:600px;margin-left:auto;margin-right:auto}
        .hero-buttons{display:flex;gap:20px;justify-content:center;flex-wrap:wrap}
        .hero-btn{display:flex;align-items:center;gap:12px;padding:20px 40px;border-radius:var(--radius);font-family:var(--font-body);font-size:1.05rem;font-weight:600;cursor:pointer;transition:all .3s;border:2px solid transparent;text-decoration:none;min-width:240px;justify-content:center}
        .hero-btn-patients{background:#fff;color:var(--primary-dark)}
        .hero-btn-patients:hover{transform:translateY(-3px);box-shadow:0 12px 40px rgba(255,255,255,.2)}
        .hero-btn-professionals{background:transparent;border-color:rgba(255,255,255,.4);color:#fff}
        .hero-btn-professionals:hover{background:rgba(255,255,255,.1);border-color:#fff;transform:translateY(-3px)}
        .hero-btn-icon{font-size:1.4rem}
        .hero-footer{position:absolute;bottom:20px;left:0;right:0;text-align:center;z-index:2;color:rgba(255,255,255,.4);font-size:.78rem}
        .hero-footer a{color:rgba(255,255,255,.5);text-decoration:none}

        /* ‚ïê‚ïê‚ïê PAGE VIEWS ‚ïê‚ïê‚ïê */
        .page{display:none;min-height:100vh}
        .page.active{display:flex;flex-direction:column}
        .page-back{display:inline-flex;align-items:center;gap:6px;color:rgba(255,255,255,.7);text-decoration:none;font-size:.88rem;font-weight:500;padding:8px 16px;border-radius:6px;transition:.2s;cursor:pointer;border:none;background:none;font-family:var(--font-body)}
        .page-back:hover{color:#fff;background:rgba(255,255,255,.08)}

        /* ‚ïê‚ïê‚ïê PATIENTS DASHBOARD ‚ïê‚ïê‚ïê */
        .patients-header{background:linear-gradient(135deg,var(--bg-dark),#243347);padding:30px 40px 20px;color:#fff}
        .patients-header h2{font-family:var(--font-display);font-size:1.8rem;margin-bottom:6px}
        .patients-header p{font-size:.9rem;opacity:.7;font-weight:300}
        .patients-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px;padding:30px 40px;max-width:1200px;margin:0 auto}
        .patient-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:22px;cursor:pointer;transition:all .25s;position:relative;overflow:hidden;text-decoration:none;color:var(--text)}
        .patient-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--primary),var(--accent));transform:scaleX(0);transform-origin:left;transition:transform .3s}
        .patient-card:hover::before{transform:scaleX(1)}
        .patient-card:hover{border-color:var(--primary-light);box-shadow:var(--shadow-md);transform:translateY(-2px)}
        .patient-card-icon{font-size:2rem;margin-bottom:12px}
        .patient-card-title{font-family:var(--font-display);font-weight:600;font-size:1.05rem;color:var(--primary-dark);margin-bottom:4px}
        .patient-card-desc{font-size:.82rem;color:var(--text-muted);font-weight:300}

        /* ‚ïê‚ïê‚ïê PROFESSIONALS (existing dashboard) ‚ïê‚ïê‚ïê */
        .prof-layout{display:grid;grid-template-columns:280px 1fr 300px;flex:1;overflow:hidden}
        .prof-layout .top-nav{display:none}
        .sidebar-left{background:var(--bg-card);border-right:1px solid var(--border);display:flex;flex-direction:column;overflow:hidden}
        .sidebar-hero{padding:24px 22px 20px;background:linear-gradient(135deg,var(--bg-dark),#243347);color:#fff;position:relative;overflow:hidden}
        .sidebar-hero::before{content:'';position:absolute;top:-30px;right:-30px;width:100px;height:100px;background:var(--primary);opacity:.15;border-radius:50%}
        .sidebar-hero h2{font-family:var(--font-display);font-size:1.15rem;font-weight:600;margin-bottom:4px}
        .sidebar-hero p{font-size:.78rem;opacity:.7;font-weight:300}
        .categories-list{flex:1;overflow-y:auto;padding:8px 0}
        .category-btn{display:flex;align-items:center;gap:10px;width:100%;padding:12px 22px;text-align:left;border:none;background:0 0;cursor:pointer;font-size:.88rem;color:var(--text);font-family:var(--font-body);transition:.2s;border-left:3px solid transparent}
        .category-btn:hover{background:var(--border-light);border-left-color:var(--primary-light)}
        .category-btn.active{background:linear-gradient(90deg,rgba(26,107,74,.06),transparent);border-left-color:var(--primary);color:var(--primary);font-weight:600}
        .cat-emoji{font-size:1.05rem;width:24px;text-align:center}
        .main-content{display:flex;flex-direction:column;background:var(--bg-main);overflow:hidden}
        .content-header{padding:20px 28px;background:var(--bg-card);border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
        .content-header h3{font-family:var(--font-display);font-size:1.5rem;font-weight:700;color:var(--primary-dark)}
        .content-area{flex:1;overflow-y:auto;padding:24px 28px}
        .tab-buttons{display:flex;gap:2px;margin-bottom:24px;background:var(--bg-card);border-radius:var(--radius);padding:4px;box-shadow:var(--shadow-sm);border:1px solid var(--border)}
        .tab-btn{flex:1;padding:10px 12px;border:none;background:0 0;cursor:pointer;color:var(--text-light);font-weight:500;font-size:.84rem;border-radius:var(--radius-sm);transition:.2s;font-family:var(--font-body);white-space:nowrap}
        .tab-btn.active{background:var(--primary);color:#fff;box-shadow:0 2px 8px rgba(26,107,74,.25)}
        .tab-btn:hover:not(.active){background:var(--bg-subtle);color:var(--text)}
        .tab-content{display:none}.tab-content.active{display:block;animation:fadeUp .3s ease}
        @keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
        .question-input{display:flex;gap:10px;margin-bottom:20px}
        .question-input input{flex:1;padding:13px 18px;border:2px solid var(--border);border-radius:var(--radius);font-size:.92rem;font-family:var(--font-body);background:var(--bg-card);transition:.2s}
        .question-input input:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 4px rgba(26,107,74,.1)}
        .btn{padding:11px 22px;border:none;border-radius:var(--radius-sm);cursor:pointer;font-weight:600;font-size:.88rem;transition:.2s;font-family:var(--font-body)}
        .btn-primary{background:linear-gradient(135deg,var(--primary),var(--primary-light));color:#fff}
        .btn-primary:hover:not(:disabled){box-shadow:0 4px 16px rgba(26,107,74,.35);transform:translateY(-1px)}
        .btn-primary:disabled{opacity:.5;cursor:not-allowed;transform:none}
        .btn-secondary{background:var(--bg-subtle);color:var(--text)}.btn-secondary:hover{background:var(--border)}
        .btn-small{padding:8px 16px;font-size:.82rem}
        .question-box{background:var(--bg-card);padding:18px 20px;border-radius:var(--radius);margin-bottom:14px;border-left:4px solid var(--primary);box-shadow:var(--shadow-sm);animation:fadeUp .3s;transition:box-shadow .2s;position:relative}
        .question-box:hover{box-shadow:var(--shadow-md)}
        .question-text{font-family:var(--font-display);color:var(--primary-dark);font-weight:600;margin-bottom:10px;font-size:1rem}
        .answer-text{color:var(--text);line-height:1.7;font-size:.92rem;white-space:pre-wrap;word-wrap:break-word;font-weight:300}
        .note-time{font-size:.76rem;color:var(--text-muted);margin-top:10px;font-weight:500}
        .doc-item{background:var(--bg-card);padding:14px 18px;border-radius:var(--radius-sm);margin-bottom:8px;border:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;transition:.2s}
        .doc-item:hover{border-color:var(--primary-light);box-shadow:var(--shadow-sm)}
        .doc-name{font-weight:600;color:var(--text);font-size:.88rem;margin-bottom:2px}.doc-size{font-size:.78rem;color:var(--text-muted)}
        .doc-btn{background:linear-gradient(135deg,var(--primary),var(--primary-light));color:#fff;padding:7px 16px;border:none;border-radius:6px;cursor:pointer;font-size:.82rem;text-decoration:none;font-weight:600;transition:.2s}
        .empty-state{text-align:center;padding:48px 24px;color:var(--text-muted)}.empty-state-icon{font-size:2.8rem;margin-bottom:12px;opacity:.6}.empty-state p{font-size:.92rem;font-weight:300}
        .studio-intro{background:linear-gradient(135deg,var(--bg-dark),#243347);border-radius:var(--radius);padding:22px 24px;margin-bottom:20px;color:#fff;position:relative;overflow:hidden}
        .studio-intro::after{content:'‚ú®';position:absolute;right:20px;top:50%;transform:translateY(-50%);font-size:2.5rem;opacity:.15}
        .studio-intro h4{font-family:var(--font-display);font-size:1.15rem;margin-bottom:6px}
        .studio-intro p{font-size:.86rem;opacity:.8;font-weight:300}
        .studio-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px}
        .studio-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:18px;cursor:pointer;transition:.25s;text-align:left;font-family:var(--font-body);position:relative;overflow:hidden}
        .studio-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--primary),var(--accent));transform:scaleX(0);transform-origin:left;transition:transform .3s}
        .studio-card:hover:not(:disabled)::before{transform:scaleX(1)}
        .studio-card:hover:not(:disabled){border-color:var(--primary-light);box-shadow:var(--shadow-md);transform:translateY(-2px)}
        .studio-card:disabled{opacity:.4;cursor:not-allowed}
        .studio-card-icon{font-size:1.5rem;margin-bottom:8px}.studio-card-title{font-weight:600;font-size:.9rem;color:var(--text)}.studio-card-desc{font-size:.78rem;color:var(--text-muted);font-weight:300}
        .config-box{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:22px;margin-bottom:16px}
        .config-box h4{font-family:var(--font-display);color:var(--primary-dark);margin-bottom:12px;font-size:1rem}
        .config-row{display:flex;gap:8px;margin-bottom:10px;align-items:center}
        .config-row input,.config-row select{flex:1;padding:10px 14px;border:2px solid var(--border);border-radius:var(--radius-sm);font-size:.86rem;font-family:var(--font-body);background:var(--bg-main)}
        .config-row input:focus,.config-row select:focus{outline:none;border-color:var(--primary)}
        .config-hint{font-size:.8rem;color:var(--text-light);margin-top:4px;line-height:1.6}
        .config-hint a{color:var(--primary);font-weight:600}
        .sidebar-right{background:var(--bg-card);border-left:1px solid var(--border);padding:24px 20px;overflow-y:auto}
        .sidebar-section-title{font-family:var(--font-display);font-weight:600;margin:0 0 14px;color:var(--primary-dark);font-size:1rem}
        .stat-card{background:var(--bg-main);padding:14px 16px;border-radius:var(--radius-sm);margin-bottom:8px;border:1px solid var(--border-light)}
        .stat-label{font-size:.76rem;color:var(--text-muted);margin-bottom:4px;text-transform:uppercase;letter-spacing:.05em;font-weight:600}
        .stat-value{font-family:var(--font-display);font-size:1.6rem;font-weight:700;color:var(--primary)}
        .model-badge{display:inline-block;background:linear-gradient(135deg,rgba(26,107,74,.08),rgba(26,107,74,.04));color:var(--primary);padding:4px 12px;border-radius:20px;font-size:.76rem;font-weight:600;font-family:Consolas,monospace;border:1px solid rgba(26,107,74,.15)}
        .info-box{background:linear-gradient(135deg,var(--bg-dark),#243347);padding:18px;border-radius:var(--radius);font-size:.84rem;line-height:1.6;color:rgba(255,255,255,.85)}
        .info-box strong{color:#fff}
        .sidebar-footer{padding:14px 22px;border-top:1px solid var(--border);font-size:.72rem;color:var(--text-muted);text-align:center}
        .sidebar-footer a{color:var(--primary);text-decoration:none}
        .nav-status{padding:5px 14px;border-radius:20px;font-size:.78rem;font-weight:600}
        .nav-status.ok{background:rgba(34,197,94,.15);color:#4ade80}.nav-status.wait{background:rgba(234,179,8,.15);color:#fbbf24}
        .scrollbar::-webkit-scrollbar{width:6px}.scrollbar::-webkit-scrollbar-track{background:0 0}.scrollbar::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
        @media(max-width:1024px){.prof-layout{grid-template-columns:1fr}.sidebar-left,.sidebar-right{display:none}.landing-nav .nav-links{display:none}.hero-content h2{font-size:2rem}.hero-buttons{flex-direction:column;align-items:center}.patients-grid{padding:20px}}
    </style>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LANDING PAGE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page active" id="pageLanding">
    <div class="landing">
        <nav class="landing-nav"><div class="brand"><div class="logo">üè•</div><h1>Centro de Salud <span>Cartagena Este</span></h1></div><div class="nav-links"><a href="https://cartagenaeste.es/" target="_blank">Web</a><a href="https://cartagenaeste.es/home/blog-categorias/" target="_blank">Blog</a><a href="https://cartagenaeste.es/podcast-2/" target="_blank">Podcast</a></div></nav>
        <div class="hero">
            <div class="hero-bg"></div>
            <div class="hero-overlay"></div>
            <div class="hero-content">
                <div class="hero-badge">Centro de Salud Virgen de la Caridad</div>
                <h2>Tu salud, nuestra prioridad</h2>
                <p>Salud y formaci√≥n para tu comunidad. Accede a recursos para pacientes o herramientas de docencia cl√≠nica para profesionales.</p>
                <div class="hero-buttons">
                    <a class="hero-btn hero-btn-patients" onclick="showPage('pagePatients')"><span class="hero-btn-icon">üë§</span> Pacientes</a>
                    <a class="hero-btn hero-btn-professionals" onclick="showPage('pageProfessionals')"><span class="hero-btn-icon">ü©∫</span> Profesionales</a>
                </div>
            </div>
            <div class="hero-footer">¬© 2026 <a href="https://cartagenaeste.es" target="_blank">cartagenaeste.es</a> ¬∑ Creado con ‚ù§Ô∏è</div>
        </div>
    </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PATIENTS PAGE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page" id="pagePatients">
    <nav class="landing-nav"><div class="brand"><div class="logo">üè•</div><h1>Centro de Salud <span>Cartagena Este</span></h1></div><div class="nav-links"><button class="page-back" onclick="showPage('pageLanding')">‚Üê Inicio</button></div></nav>
    <div class="patients-header"><h2>üë§ Pacientes</h2><p>Recursos e informaci√≥n para pacientes del Centro de Salud</p></div>
    <div class="patients-grid" id="patientsGrid"></div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PROFESSIONALS PAGE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page" id="pageProfessionals">
    <nav class="landing-nav"><div class="brand"><div class="logo">üè•</div><h1>Centro de Salud <span>Cartagena Este</span></h1></div><div class="nav-links"><button class="page-back" onclick="showPage('pageLanding')">‚Üê Inicio</button><span id="statusBadge" class="nav-status wait">‚öôÔ∏è Config</span></div></nav>
    <div class="prof-layout">
        <div class="sidebar-left"><div class="sidebar-hero"><h2>Especialidades</h2><p>Cuaderno AI ¬∑ Docencia Cl√≠nica</p></div><div class="categories-list scrollbar" id="categoriesList"></div><div class="sidebar-footer">¬© 2026 <a href="https://cartagenaeste.es" target="_blank">cartagenaeste.es</a></div></div>
        <div class="main-content"><div class="content-header"><h3 id="categoryTitle">Cardiolog√≠a</h3></div>
            <div class="content-area scrollbar">
                <div class="tab-buttons"><button class="tab-btn active" onclick="switchTab('preguntas',this)">ü§ñ Preguntas IA</button><button class="tab-btn" onclick="switchTab('documentos',this)">üìö Documentos</button><button class="tab-btn" onclick="switchTab('notas',this)">üìù Notas</button><button class="tab-btn" onclick="switchTab('studio',this)">‚ú® Studio</button><button class="tab-btn" onclick="switchTab('recursos',this)">üìã Recursos</button><button class="tab-btn" onclick="switchTab('config',this)">‚öôÔ∏è Config</button></div>
                <div id="preguntas" class="tab-content active"><div class="question-input"><input type="text" id="preguntaInput" placeholder="Haz una pregunta cl√≠nica..." spellcheck="false"><button class="btn btn-primary" onclick="hacerPregunta()" id="btnPreguntar">Preguntar</button></div><div id="preguntasList"><div class="empty-state"><div class="empty-state-icon">ü©∫</div><p>Haz tu primera pregunta cl√≠nica</p></div></div></div>
                <div id="documentos" class="tab-content"><div id="documentosList" style="margin-top:8px"></div></div>
                <div id="notas" class="tab-content"><div style="margin-bottom:20px"><textarea id="noteInput" placeholder="Escribe tus notas cl√≠nicas..." style="width:100%;padding:14px;border:2px solid var(--border);border-radius:var(--radius);min-height:90px;font-family:var(--font-body);resize:vertical;font-size:.92rem;background:var(--bg-card)"></textarea><div style="margin-top:10px;display:flex;gap:10px"><button class="btn btn-primary btn-small" onclick="agregarNota()">‚úì Guardar</button><button class="btn btn-secondary btn-small" onclick="document.getElementById('noteInput').value=''">Limpiar</button></div></div><div id="notasList"></div></div>
                <div id="studio" class="tab-content"><div class="studio-intro"><h4>AI Studio ¬∑ Generador Cl√≠nico</h4><p>Genera contenido m√©dico sobre <strong id="studioCategory">Cardiolog√≠a</strong> con IA.</p></div><div class="studio-grid"><button class="studio-card" onclick="studioAction('resumen')"><div class="studio-card-icon">üìã</div><div class="studio-card-title">Resumen ejecutivo</div><div class="studio-card-desc">Puntos clave</div></button><button class="studio-card" onclick="studioAction('faq')"><div class="studio-card-icon">‚ùì</div><div class="studio-card-title">FAQ Cl√≠nico</div><div class="studio-card-desc">Preguntas frecuentes</div></button><button class="studio-card" onclick="studioAction('guia')"><div class="studio-card-icon">üìñ</div><div class="studio-card-title">Gu√≠a de estudio</div><div class="studio-card-desc">Conceptos y repaso</div></button><button class="studio-card" onclick="studioAction('diagnostico')"><div class="studio-card-icon">ü©∫</div><div class="studio-card-title">Diagn√≥stico diferencial</div><div class="studio-card-desc">Patolog√≠as principales</div></button><button class="studio-card" onclick="studioAction('farmacologia')"><div class="studio-card-icon">üíä</div><div class="studio-card-title">Farmacolog√≠a</div><div class="studio-card-desc">F√°rmacos y dosis</div></button><button class="studio-card" onclick="studioAction('emergencia')"><div class="studio-card-icon">üö®</div><div class="studio-card-title">Protocolo emergencia</div><div class="studio-card-desc">Actuaci√≥n urgente</div></button></div><div id="studioResult" style="display:none"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px"><h4 style="font-family:var(--font-display);color:var(--primary-dark)" id="studioResultTitle"></h4><button class="btn btn-primary btn-small" onclick="guardarStudioComoNota()">üíæ Guardar</button></div><div id="studioResultContent" class="scrollbar" style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:20px;line-height:1.7;font-size:.92rem;white-space:pre-wrap;max-height:400px;overflow-y:auto;font-weight:300"></div></div></div>
                <div id="recursos" class="tab-content"><div style="padding:16px 0;"><h3 style="font-family:var(--font-display);color:var(--primary-dark);margin-bottom:20px;font-size:1.2rem">üìã Recursos Sociales</h3><p style="color:var(--text-light);margin-bottom:20px;font-size:.9rem">Formularios y documentos oficiales para prestaciones sociales, pensiones y servicios de dependencia.</p><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;"><a href="recursos-sociales-grado-dependencia.pdf" target="_blank" style="text-decoration:none;"><div style="background:var(--bg-card);border:2px solid var(--border);border-radius:var(--radius);padding:16px;cursor:pointer;transition:all .2s;text-align:center;hover:border-color:var(--primary)"><div style="font-size:1.8rem;margin-bottom:8px">üìã</div><div style="font-weight:600;color:var(--primary-dark);font-size:.95rem;margin-bottom:4px">Grado de Dependencia</div><div style="font-size:.78rem;color:var(--text-muted)">2.0 MB ¬∑ PDF</div></div></a><a href="recursos-sociales-ayuda-domicilio.pdf" target="_blank" style="text-decoration:none;"><div style="background:var(--bg-card);border:2px solid var(--border);border-radius:var(--radius);padding:16px;cursor:pointer;transition:all .2s;text-align:center"><div style="font-size:1.8rem;margin-bottom:8px">üè†</div><div style="font-weight:600;color:var(--primary-dark);font-size:.95rem;margin-bottom:4px">Ayuda a Domicilio</div><div style="font-size:.78rem;color:var(--text-muted)">825 KB ¬∑ PDF</div></div></a><a href="recursos-sociales-servicios-domiciliarios.pdf" target="_blank" style="text-decoration:none;"><div style="background:var(--bg-card);border:2px solid var(--border);border-radius:var(--radius);padding:16px;cursor:pointer;transition:all .2s;text-align:center"><div style="font-size:1.8rem;margin-bottom:8px">üë®‚Äç‚öïÔ∏è</div><div style="font-weight:600;color:var(--primary-dark);font-size:.95rem;margin-bottom:4px">Servicios Domiciliarios</div><div style="font-size:.78rem;color:var(--text-muted)">213 KB ¬∑ PDF</div></div></a><a href="recursos-sociales-pension-jubilacion.pdf" target="_blank" style="text-decoration:none;"><div style="background:var(--bg-card);border:2px solid var(--border);border-radius:var(--radius);padding:16px;cursor:pointer;transition:all .2s;text-align:center"><div style="font-size:1.8rem;margin-bottom:8px">üí∞</div><div style="font-weight:600;color:var(--primary-dark);font-size:.95rem;margin-bottom:4px">Pensi√≥n Jubilaci√≥n</div><div style="font-size:.78rem;color:var(--text-muted)">1.9 MB ¬∑ PDF</div></div></a><a href="recursos-sociales-punto-acceso.pdf" target="_blank" style="text-decoration:none;"><div style="background:var(--bg-card);border:2px solid var(--border);border-radius:var(--radius);padding:16px;cursor:pointer;transition:all .2s;text-align:center"><div style="font-size:1.8rem;margin-bottom:8px">üìû</div><div style="font-weight:600;color:var(--primary-dark);font-size:.95rem;margin-bottom:4px">PASS</div><div style="font-size:.78rem;color:var(--text-muted)">29 KB ¬∑ PDF</div></div></a></div><div style="margin-top:24px;background:linear-gradient(135deg,var(--bg-dark),#243347);border-radius:var(--radius);padding:18px;color:#fff;font-size:.88rem;line-height:1.6;"><strong>‚òéÔ∏è Contacto Servicios Sociales</strong><br>üìç C/ Sor Francisca Armend√°riz, s/n ¬∑ Cartagena<br>üìû 900 923 491<br>‚è∞ L-V 9:00-12:30 (presencial) / 9:00-13:00 (tel√©fono)<br><br><strong style="margin-top:10px;display:block">üåê Sedes Electr√≥nicas</strong><br><a href="https://www.cartagena.es" target="_blank" style="color:rgba(255,255,255,.8)">cartagena.es</a> ¬∑ <a href="https://sede.carm.es" target="_blank" style="color:rgba(255,255,255,.8)">sede.carm.es</a></div></div></div>
                <div id="config" class="tab-content"><div class="config-box"><h4>Proveedor de IA</h4><div class="config-row"><select id="cfgProvider" onchange="cambiarProvider()"><option value="groq">Groq (recomendado ¬∑ ultra r√°pido)</option><option value="qwen">Qwen API directa (Alibaba Cloud)</option></select></div><div id="groqConfig"><p class="config-hint" style="margin-bottom:10px"><strong>Groq</strong> ‚Äî Gratis, ultra r√°pido<br>1. <a href="https://console.groq.com" target="_blank">console.groq.com</a><br>2. Crea cuenta gratis<br>3. API Keys ‚Üí Create<br>4. Pega key (<code>gsk_</code>)</p><div class="config-row"><input type="password" id="cfgGroqKey" placeholder="gsk_xxxxxxxxxxxx"></div><h4 style="margin-top:12px">Modelo</h4><div class="config-row"><select id="cfgGroqModel"><option value="qwen/qwen3-32b">Qwen3 32B</option><option value="llama-3.3-70b-versatile">Llama 3.3 70B</option><option value="deepseek-r1-distill-llama-70b">DeepSeek R1 70B</option><option value="gemma2-9b-it">Gemma 2 9B</option></select></div></div><div id="qwenConfig" style="display:none"><p class="config-hint" style="margin-bottom:10px"><strong>Qwen API</strong><br>1. <a href="https://www.alibabacloud.com/help/en/model-studio/get-api-key" target="_blank">Alibaba Cloud</a><br>2. Crea API Key (<code>sk-</code>)</p><div class="config-row"><input type="password" id="cfgQwenKey" placeholder="sk-xxxxxxxxxxxx"></div><h4 style="margin-top:12px">Modelo</h4><div class="config-row"><select id="cfgQwenModel"><option value="qwen-turbo">Qwen Turbo</option><option value="qwen-plus">Qwen Plus</option><option value="qwen3-32b">Qwen3 32B</option><option value="qwen-max">Qwen Max</option></select></div></div><div style="margin-top:16px;display:flex;gap:8px"><button class="btn btn-primary btn-small" onclick="guardarConfig()">üíæ Guardar</button><button class="btn btn-secondary btn-small" onclick="testApiKey()">üß™ Probar</button></div><div id="cfgStatus" style="margin-top:12px"></div></div></div>
            </div>
        </div>
        <div class="sidebar-right scrollbar"><div class="sidebar-section-title">Estad√≠sticas</div><div class="stat-card"><div class="stat-label">Documentos</div><div class="stat-value" id="docsCount">0</div></div><div class="stat-card"><div class="stat-label">Preguntas</div><div class="stat-value" id="preguntasCount">0</div></div><div class="stat-card"><div class="stat-label">Notas</div><div class="stat-value" id="notasCount">0</div></div><div style="margin-top:18px"><div class="sidebar-section-title">Modelo Activo</div><div class="stat-card"><span class="model-badge" id="modelBadge">--</span><div style="font-size:.78rem;color:var(--text-muted);margin-top:8px" id="modelInfo">Config</div></div></div><div class="info-box" style="margin-top:18px"><strong>üè• Cuaderno AI</strong><br>Docencia cl√≠nica con IA para Cartagena Este.<br><br>‚Ä¢ IA gratuita<br>‚Ä¢ Res√∫menes autom√°ticos<br>‚Ä¢ Estudio por especialidades</div></div>
    </div>
</div>

<script>
// ‚ïê‚ïê‚ïê PATIENTS DATA ‚ïê‚ïê‚ïê
var patientSections=[
    {icon:"ü•ó",title:"Dietas",desc:"Planes nutricionales",url:"dietas.html"},
    {icon:"üíú",title:"Violencia de g√©nero",desc:"Recursos y apoyo",url:"https://cartagenaeste.es/category/violencia-de-genero/"},
    {icon:"ü§ù",title:"Recursos sociales",desc:"Servicios comunitarios",url:"recursos-sociales.html"},
    {icon:"‚ÑπÔ∏è",title:"Informaci√≥n",desc:"Info general del centro",url:"https://cartagenaeste.es/category/informacion/"},
    {icon:"‚ö†Ô∏è",title:"Factores de riesgo",desc:"Prevenci√≥n y salud",url:"https://cartagenaeste.es/category/factores-de-riesgo/"},
    {icon:"üèÉ",title:"Ejercicios",desc:"Gu√≠as de actividad f√≠sica",url:"https://cartagenaeste.es/category/ejercicios/"},
    {icon:"ü¶∑",title:"Dentista",desc:"Salud bucodental",url:"https://cartagenaeste.es/category/dentista/"},
    {icon:"üîó",title:"Enlaces de inter√©s",desc:"Webs y recursos √∫tiles",url:"https://cartagenaeste.es/category/enlaces-de-interes/"},
    {icon:"üíâ",title:"Vacunas",desc:"Calendario y campa√±as",url:"https://cartagenaeste.es/category/vacunas/"},
    {icon:"üìÖ",title:"Programaci√≥n del Centro",desc:"Horarios y agenda",url:"https://cartagenaeste.es/category/pacientes/programacion-del-centro/"},
    {icon:"üö≠",title:"Dejar de fumar",desc:"Programas y ayuda",url:"https://cartagenaeste.es/category/dejar-de-fumar/"},
    {icon:"üéôÔ∏è",title:"Podcast",desc:"Audio salud comunitaria",url:"https://cartagenaeste.es/podcast-2/"}
];

function renderPatients(){
    var g=document.getElementById("patientsGrid");
    g.innerHTML=patientSections.map(function(s){return'<a class="patient-card" href="'+s.url+'" target="_blank"><div class="patient-card-icon">'+s.icon+'</div><div class="patient-card-title">'+s.title+'</div><div class="patient-card-desc">'+s.desc+'</div></a>'}).join("");
}

// ‚ïê‚ïê‚ïê PAGE NAVIGATION ‚ïê‚ïê‚ïê
function showPage(id){
    document.querySelectorAll(".page").forEach(function(p){p.classList.remove("active")});
    document.getElementById(id).classList.add("active");
    if(id==="pageProfessionals")initProfessionals();
}

// ‚ïê‚ïê‚ïê PROFESSIONALS LOGIC (all existing code) ‚ïê‚ïê‚ïê
var categories={"Cardiolog√≠a":"‚ù§Ô∏è","Dermatolog√≠a":"ü©π","Digestivo":"ü´Å","Endocrinolog√≠a":"üß¨","Geriatr√≠a":"üë¥","Ginecolog√≠a":"ü§∞","Neurolog√≠a":"üß†","Neumolog√≠a":"üí®","Pediatr√≠a":"üë∂","Traumatolog√≠a":"ü¶¥","Protocolos M√©dicos":"üìã"};
var currentCategory="Cardiolog√≠a",documents={},preguntas={},notas={},isProcessing=false,profInitialized=false;
var CONFIG={provider:"groq",groqKey:"",groqModel:"qwen/qwen3-32b",qwenKey:"",qwenModel:"qwen-turbo"};
try{var s=localStorage.getItem("notebook_ai_cfg_v3");if(s)Object.assign(CONFIG,JSON.parse(s));}catch(e){}
var ENDPOINTS={groq:{url:"https://api.groq.com/openai/v1/chat/completions",getKey:function(){return CONFIG.groqKey},getModel:function(){return CONFIG.groqModel},prefix:"gsk_"},qwen:{url:"https://dashscope-intl.aliyuncs.com/compatible-mode/v1/chat/completions",getKey:function(){return CONFIG.qwenKey},getModel:function(){return CONFIG.qwenModel},prefix:"sk-"}};
function ep(){return ENDPOINTS[CONFIG.provider]||ENDPOINTS.groq}
function isReady(){var e=ep();var k=e.getKey();return k&&k.startsWith(e.prefix)}
function updateStatus(){var el=document.getElementById("statusBadge"),b=document.getElementById("modelBadge"),i=document.getElementById("modelInfo");if(!el)return;if(isReady()){el.className="nav-status ok";el.textContent="‚úÖ IA Conectada";b.textContent=ep().getModel().split("/").pop();i.textContent=CONFIG.provider==="groq"?"Groq ¬∑ Gratuito":"Qwen ¬∑ Alibaba";}else{el.className="nav-status wait";el.textContent="‚öôÔ∏è Config";b.textContent="--";i.textContent="Configura API Key";}}
function cambiarProvider(){var v=document.getElementById("cfgProvider").value;document.getElementById("groqConfig").style.display=v==="groq"?"block":"none";document.getElementById("qwenConfig").style.display=v==="qwen"?"block":"none";}
async function fetchWithCorsProxy(url,options){try{var r=await fetch(url,options);return r;}catch(e){console.log("Direct failed, trying proxy...");} var proxies=["https://corsproxy.io/?url=","https://api.allorigins.win/raw?url="];for(var i=0;i<proxies.length;i++){try{return await fetch(proxies[i]+encodeURIComponent(url),options);}catch(e){}}throw new Error("No se pudo conectar.");}
async function llamarIA(up,sp){if(!isReady())return"‚ö†Ô∏è Configura API Key en ‚öôÔ∏è Config";var e=ep();try{var r=await fetchWithCorsProxy(e.url,{method:"POST",headers:{"Content-Type":"application/json","Authorization":"Bearer "+e.getKey()},body:JSON.stringify({model:e.getModel(),messages:[{role:"system",content:sp||"Eres un asistente m√©dico. Responde en espa√±ol."},{role:"user",content:up}],temperature:.7,max_tokens:2048})});if(!r.ok){var err=await r.json().catch(function(){return{}});if(r.status===401)return"‚ùå API Key inv√°lida";if(r.status===429)return"‚è≥ L√≠mite. Espera.";return"‚ùå Error "+r.status+": "+(err.error&&err.error.message?err.error.message:"");}var d=await r.json();var c=(d.choices&&d.choices[0]&&d.choices[0].message)?d.choices[0].message.content:"Sin respuesta";return c.replace(/<think>[\s\S]*?<\/think>/g,"").trim()||"Sin respuesta";}catch(e){return"‚ùå "+e.message}}
async function hacerPregunta(){var input=document.getElementById("preguntaInput"),q=input.value.trim();if(!q||isProcessing)return;if(!isReady()){switchTab("config",document.querySelectorAll(".tab-btn")[4]);return;}isProcessing=true;document.getElementById("btnPreguntar").disabled=true;if(!preguntas[currentCategory])preguntas[currentCategory]=[];var idx=preguntas[currentCategory].length;preguntas[currentCategory].push({pregunta:q,respuesta:"‚è≥ Consultando...",fecha:new Date().toLocaleString("es-ES")});input.value="";actualizarUI();var docs=documents[currentCategory]||[];var dc=docs.map(function(d){return"- "+d.name}).join("\n");var sys="Eres un asistente m√©dico especializado en "+currentCategory+". Responde en espa√±ol."+(dc?"\nDocs:\n"+dc:"");var r=await llamarIA(q,sys);preguntas[currentCategory][idx].respuesta=r;guardarDatos();actualizarUI();isProcessing=false;document.getElementById("btnPreguntar").disabled=false;}
var studioPrompts={resumen:{title:"üìã Resumen ‚Äî ",prompt:"Resumen ejecutivo sobre {cat}: patolog√≠as, diagn√≥sticos, tratamientos."},faq:{title:"‚ùì FAQ ‚Äî ",prompt:"8 preguntas frecuentes sobre {cat} con respuestas."},guia:{title:"üìñ Gu√≠a ‚Äî ",prompt:"Gu√≠a de estudio {cat}: conceptos, clasificaciones, f√°rmacos, dosis."},diagnostico:{title:"ü©∫ Dx ‚Äî ",prompt:"Diagn√≥stico diferencial de {cat}: s√≠ntomas, pruebas, red flags."},farmacologia:{title:"üíä Farma ‚Äî ",prompt:"Farmacolog√≠a {cat}: grupos, mecanismo, dosis, efectos adversos."},emergencia:{title:"üö® Urgencia ‚Äî ",prompt:"Protocolos emergencia {cat}: reconocimiento, tratamiento, dosis."}};
var lastSC="",lastST="";
async function studioAction(t){if(!isReady()||isProcessing)return;var c=studioPrompts[t];if(!c)return;isProcessing=true;document.querySelectorAll(".studio-card").forEach(function(x){x.disabled=true});var rd=document.getElementById("studioResult"),cd=document.getElementById("studioResultContent");lastST=c.title+currentCategory;document.getElementById("studioResultTitle").textContent=lastST;cd.textContent="‚è≥ Generando...";rd.style.display="block";lastSC=await llamarIA(c.prompt.replace(/\{cat\}/g,currentCategory),"Experto m√©dico. Responde en espa√±ol.");cd.textContent=lastSC;isProcessing=false;document.querySelectorAll(".studio-card").forEach(function(x){x.disabled=false});}
function guardarStudioComoNota(){if(!lastSC)return;if(!notas[currentCategory])notas[currentCategory]=[];notas[currentCategory].push({texto:lastST+"\n\n"+lastSC,fecha:new Date().toLocaleString("es-ES")});guardarDatos();actualizarUI();alert("‚úÖ Guardado")}
function agregarNota(){var t=document.getElementById("noteInput").value.trim();if(!t)return;if(!notas[currentCategory])notas[currentCategory]=[];notas[currentCategory].push({texto:t,fecha:new Date().toLocaleString("es-ES")});document.getElementById("noteInput").value="";guardarDatos();actualizarUI();}
function eliminarNota(i){if(!confirm("¬øEliminar?"))return;notas[currentCategory].splice(i,1);guardarDatos();actualizarUI();}
function switchTab(n,b){document.querySelectorAll(".tab-content").forEach(function(t){t.classList.remove("active")});document.querySelectorAll(".tab-btn").forEach(function(x){x.classList.remove("active")});document.getElementById(n).classList.add("active");if(b)b.classList.add("active");}
function cambiarCategoria(c,b){currentCategory=c;document.querySelectorAll(".category-btn").forEach(function(x){x.classList.remove("active")});if(b)b.classList.add("active");document.getElementById("categoryTitle").textContent=c;var sc=document.getElementById("studioCategory");if(sc)sc.textContent=c;switchTab("preguntas",document.querySelector(".tab-btn"));actualizarUI();}
function esc(t){if(!t)return"";return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}
function actualizarUI(){var docs=documents[currentCategory]||[];document.getElementById("documentosList").innerHTML=docs.length===0?'<div class="empty-state"><div class="empty-state-icon">üìÑ</div><p>No hay documentos</p></div>':docs.map(function(d){return'<div class="doc-item"><div><div class="doc-name">'+d.name+'</div><div class="doc-size">'+d.size_mb+' MB ¬∑ '+d.type+'</div></div><a href="'+d.url+'" target="_blank" class="doc-btn">Abrir</a></div>'}).join("");document.getElementById("docsCount").textContent=docs.length;document.getElementById("preguntasCount").textContent=(preguntas[currentCategory]||[]).length;document.getElementById("notasCount").textContent=(notas[currentCategory]||[]).length;var pa=preguntas[currentCategory]||[],pl=document.getElementById("preguntasList");pl.innerHTML=pa.length===0?'<div class="empty-state"><div class="empty-state-icon">ü©∫</div><p>Haz tu primera pregunta</p></div>':pa.map(function(p){return'<div class="question-box"><div class="question-text">'+esc(p.pregunta)+'</div><div class="answer-text">'+esc(p.respuesta)+'</div><div class="note-time">'+p.fecha+'</div></div>'}).join("");var na=notas[currentCategory]||[],nl=document.getElementById("notasList");nl.innerHTML=na.length===0?'<div class="empty-state"><div class="empty-state-icon">üìù</div><p>Sin notas</p></div>':na.map(function(n,i){return'<div class="question-box" style="border-left-color:var(--accent)"><div style="font-size:.92rem;white-space:pre-wrap;padding-right:30px;font-weight:300;line-height:1.6">'+esc(n.texto)+'</div><div class="note-time">'+n.fecha+'</div><button onclick="eliminarNota('+i+')" style="position:absolute;top:12px;right:12px;background:none;border:none;cursor:pointer;opacity:.35">üóëÔ∏è</button></div>'}).join("");}
function guardarConfig(){CONFIG.provider=document.getElementById("cfgProvider").value;CONFIG.groqKey=document.getElementById("cfgGroqKey").value.trim();CONFIG.groqModel=document.getElementById("cfgGroqModel").value;CONFIG.qwenKey=document.getElementById("cfgQwenKey").value.trim();CONFIG.qwenModel=document.getElementById("cfgQwenModel").value;localStorage.setItem("notebook_ai_cfg_v3",JSON.stringify(CONFIG));updateStatus();document.getElementById("cfgStatus").innerHTML='<span style="color:var(--primary)">‚úÖ Guardado</span>';}
async function testApiKey(){guardarConfig();if(!isReady()){document.getElementById("cfgStatus").innerHTML='<span style="color:#dc2626">‚ùå Key inv√°lida</span>';return;}var st=document.getElementById("cfgStatus");st.innerHTML='<span style="color:var(--accent)">‚è≥ Probando...</span>';var e=ep();try{var r=await fetchWithCorsProxy(e.url,{method:"POST",headers:{"Content-Type":"application/json","Authorization":"Bearer "+e.getKey()},body:JSON.stringify({model:e.getModel(),messages:[{role:"user",content:"Di: OK"}],max_tokens:10})});if(r.ok)st.innerHTML='<span style="color:var(--primary)">‚úÖ ¬°Conexi√≥n exitosa!</span>';else if(r.status===401)st.innerHTML='<span style="color:#dc2626">‚ùå Key inv√°lida</span>';else{var err=await r.json().catch(function(){return{}});st.innerHTML='<span style="color:#dc2626">‚ùå Error '+r.status+"</span>";}}catch(err){st.innerHTML='<span style="color:#dc2626">‚ùå '+err.message+"</span>";}}
function guardarDatos(){localStorage.setItem("cartagena_preguntas",JSON.stringify(preguntas));localStorage.setItem("cartagena_notas",JSON.stringify(notas));}
function cargarDatos(){try{preguntas=JSON.parse(localStorage.getItem("cartagena_preguntas"))||{};}catch(e){preguntas={};}try{notas=JSON.parse(localStorage.getItem("cartagena_notas"))||{};}catch(e){notas={};}}

function initProfessionals(){
    if(profInitialized)return;profInitialized=true;
    var p=new URLSearchParams(window.location.search),c=p.get("category");if(c&&categories[c])currentCategory=c;
    var list=document.getElementById("categoriesList");
    Object.keys(categories).forEach(function(cat){var btn=document.createElement("button");btn.className="category-btn"+(cat===currentCategory?" active":"");btn.innerHTML='<span class="cat-emoji">'+categories[cat]+'</span>'+cat;btn.onclick=function(){cambiarCategoria(cat,btn)};list.appendChild(btn);});
    document.getElementById("categoryTitle").textContent=currentCategory;
    document.getElementById("cfgProvider").value=CONFIG.provider;cambiarProvider();
    document.getElementById("cfgGroqKey").value=CONFIG.groqKey||"";document.getElementById("cfgGroqModel").value=CONFIG.groqModel;
    document.getElementById("cfgQwenKey").value=CONFIG.qwenKey||"";document.getElementById("cfgQwenModel").value=CONFIG.qwenModel;
    cargarDatos();updateStatus();actualizarUI();
    fetch("documents.json").then(function(r){return r.json()}).then(function(d){documents=d.categories;actualizarUI();}).catch(function(){});
    document.getElementById("preguntaInput").addEventListener("keypress",function(e){if(e.key==="Enter")hacerPregunta()});
    if(!isReady())setTimeout(function(){switchTab("config",document.querySelectorAll(".tab-btn")[4])},500);
}

// ‚ïê‚ïê‚ïê INIT ‚ïê‚ïê‚ïê
document.addEventListener("DOMContentLoaded",function(){
    renderPatients();
    var p=new URLSearchParams(window.location.search);
    if(p.get("view")==="professionals"||p.get("category"))showPage("pageProfessionals");
    else if(p.get("view")==="patients")showPage("pagePatients");
});
</script>
</body>
</html>
